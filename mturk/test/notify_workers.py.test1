#! /usr/bin/python

from boto.mturk.connection import MTurkRequestError
from MTurkMappingAfrica import MTurkMappingAfrica

mtma = MTurkMappingAfrica()
mtma.cur.execute('select worker_id from worker_data')
workers=(zip(*mtma.cur.fetchall()))[0]

subject = 'Mapping Africa is now on a brief hiatus'
body = '''
Dear Mechanical Turk worker,

When we deployed the beta version of the Mapping Africa project on Mechanical Turk yesterday, we inadvertently released it with a defect wherein some correctly mapped regions would occasionally be rejected in error. Several of you have pointed this out to us, and we will make sure you are paid for your work in these cases, and endeavor to have Mechanical Turk reverse the incorrect rejections.

Also, there are a number of submitted HITs that are pending approval, which we plan to approve (manually) over the next few days.

However, while we are fixing the scoring logic, we thought it prudent to take down the site until the situation has been remedied. This will likely take several days, and may take up to a week. We will inform you again once the system is back up and operational using the new algorithm.

We thank you for helping us with the Mapping Africa project to date, and hope that you will continue to assist us when we go live again.

Best regards,
             The Mapping Africa team
'''

mtma.mtcon.notify_workers(workers, subject, body)
